<!doctype html><html lang=en><head><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],["\\[","\\]"]],processEscapes:true,processEnvironments:true}}</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=UTF-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1,user-scalable=no" name=viewport><meta content="index, follow" name=robots><title>Bandit Writeup</title><meta content="Bandit Writeup" name=title><meta content=exploiitm name=author><meta content="Official blog of Cybersecurity Club, IIT Madras" name=description><meta content=website property=og:type><meta content=https://exploiitm.github.io/blog/resources/bandit_writeup/ property=og:url><meta content="exploiitm blog" property=og:site_name><meta content="Bandit Writeup" property=og:title><meta content="Official blog of Cybersecurity Club, IIT Madras" property=og:description><meta content=https://exploiitm.github.io/blog/favicon.ico property=og:image><meta content=summary_large_image property=twitter:card><meta content=https://exploiitm.github.io/blog/resources/bandit_writeup/ property=twitter:url><meta content="Bandit Writeup" property=twitter:title><meta content="Official blog of Cybersecurity Club, IIT Madras" property=twitter:description><meta content=https://exploiitm.github.io/blog/favicon.ico property=twitter:image><link href=https://exploiitm.github.io/blog/resources/bandit_writeup/ rel=canonical><link rel="shortcut icon" href=https://exploiitm.github.io/blog/favicon.ico type=image/x-icon><link href=https://speyll.github.io/suCSS/reset-min.css rel=stylesheet><link href=https://speyll.github.io/suCSS/suCSS-min.css rel=stylesheet><link href=https://exploiitm.github.io/blog/css/style.css rel=stylesheet><script defer src=https://exploiitm.github.io/blog/js/script.js></script><body><header><nav id=nav-bar><a href=https://exploiitm.github.io/> home </a><a href=/blog> blog </a><a href=/blog/writeups> writeups </a><a href=/blog/about> about </a><a href=/blog/contacts> contact </a><div><input id=theme-toggle style=display:none type=checkbox><label for=theme-toggle id=theme-toggle-label><svg class=icons id=theme-icon><use href=https://exploiitm.github.io/blog/icons.svg#lightMode></use></svg></label><audio id=theme-sound><source src=https://exploiitm.github.io/blog/click.ogg type=audio/ogg></audio></div></nav></header><main><div><a href=..>..</a>/<span class=accent-data>bandit_writeup</span></div><time datetime=2024-09-02>Published on: <span class=accent-data>2024-09-02</span></time><address rel=author>By <span class=accent-data> Tushar Jain, and exploiitm </span></address><h1>Bandit Writeup</h1><h2 id=bandit-0>Bandit 0</h2><p><code>ssh</code> command & reading the readme file through <code>cat</code> command :<p><code>ssh bandit0@bandit.labs.overthewire.org -p 2220</code><h2 id=bandit-1>Bandit 1</h2><p>We were given a dash(-) file. To open it, we cannot directly use <code>cat -</code> etc. But we can use the following command instead : <code>cat ./-</code><h2 id=bandit-2>Bandit 2</h2><p>In this level, we were given a file name with spaces in it. We just have to pass it to <code>cat</code> as a string argument : <code>cat "spaces in this filename"</code><h2 id=bandit-3>Bandit 3</h2><p>We have a directory called inhere in this level. Lets go inside it and check the contents. We see that the directory is empty. Let’s check for hidden files using <code>ls -la</code> and we will find the file<h2 id=bandit-4>Bandit 4</h2><p>When we go inside inhere directory, we see 10 different files and we are asked to open only the human readable one. We use <code>file</code> command to check contents. Only <code>file007</code> has ASCII text and it contains the password.<h2 id=bandit-5>Bandit 5</h2><p>When we go inside inhere directory, we see a lot of other directories. Given the constraints, we run the command <code>du -b -all | grep 1033</code> to get required file where <code>-b</code> flag prints file size in bytes, <code>-all</code> flag analyses all files and <code>grep</code> searches for <code>1033</code>. We can also use one more flag <code>-h</code> for human readable.<h2 id=bandit-6>Bandit 6</h2><p>First let’s go to root directory by command <code>cd /</code> . Then use command : <code>find -user bandit7 -group bandit6 -size 33c</code><h2 id=bandit-7>Bandit 7</h2><p>We were given that password lies next to word millionth. So we can use <code>cat data.txt | grep "millionth"</code>.<h2 id=bandit-8>Bandit 8</h2><p>For finding unique string, we will first sort it and then get unique string from <code>uniq</code> command. I made <code>new.txt</code> in <code>tmp</code> as that was the only location to make new files.<p>We use the following commands :<ul><li><code>cd temp</code><li><code>touch new.txt</code><li><code>sort ~/data.txt > ./tmp/new.txt</code><li><code>uniq -u ./tmp/new.txt</code></ul><h2 id=bandit-9>Bandit 9</h2><p>In this level, we just need to search for <code>=</code> in strings in <code>data.txt</code>. <code>strings data.txt | grep "="</code><h2 id=bandit-10>Bandit 10</h2><p>To decode base64, we use it with <code>-d</code> flag<h2 id=bandit-11>Bandit 11</h2><p>We can write a code to decode ROT13 or we can just go to a website(rot13.com) to solve it for us.<h2 id=bandit-12>Bandit 12</h2><p>Creating another directory called <code>this</code> in <code>tmp</code>, copying <code>data.txt</code> to <code>new.txt</code>, then reversing <code>xxd</code> by using flag <code>-r</code>. We get files that are compressed multiple times. Decompressing them gives our password.<ul><li><code>cd /tmp/</code><li><code>mkdir this</code><li><code>touch my_file</code><li><code>xxd -r new.txt > my_file</code><li>And then multiple decompressions using <code>gzip -d</code>, <code>bzip2 -d</code> or <code>tar -xf</code></ul><h2 id=bandit-13>Bandit 13</h2><p>For this all we need to do is use private key given to connect to bandit14 using <code>-i</code> flag. We use <code>ssh -i sshkey.private bandit14@bandit.labs.overthewire.org -p 2220</code><h2 id=bandit-14>Bandit 14</h2><p>We first find the password in <code>/etc/bandit_pass/bandit14</code> as specified in level 13. Then we send the password to localhost using <code>nectat</code>. Command : <code>cat bandit14 | nc localhost 3000</code><h2 id=bandit-15>Bandit 15</h2><p>Since the post is SSL Encrypted, we connect it through the following command : <code>openssl s_client -connect localhost:3001</code><h2 id=bandit-16>Bandit 16</h2><p>We are given 1000 ports that we have to check. I created a bash script in <code>new</code> directory in <code>tmp</code>.<p>Bash Script :<pre style=background:#282828;color:#fdf4c1aa><code><span>#! /bin/bash
</span><span>i=31000
</span><span>while [ 32000 -ge $i ]
</span><span>do
</span><span>	echo $i
</span><span>	openssl s_client -connect localhost:$i
</span><span>	i=$((i+1))
</span><span>done
</span></code></pre><p>Now we will have a few such instances where we would be asked to put the data (password of prev level in this case). After doing that, we can modify the script to check for later numbers and accordingly get the required correct answer.<p>Then we store the private key in <code>sshkey.private</code> and use following commands :<ul><li><code>chmod 600 sshkey.private</code> // Permission<li><code>ssh -i sshkey.private bandit17@bandit.labs.overthewire.org -p 2220</code></ul><h2 id=bandit-17>Bandit 17</h2><p>To get the difference between two files, we can use <code>vimdiff</code>. Command : <code>vimdiff passwords.old passwords.new</code><h2 id=bandit-18>Bandit 18</h2><p>We can run a command inside ssh without logging in by directly writing the command after our usual ssh command. Command : <code>ssh bandit18@bandit.labs.overthewire.org -p 2220 cat readme</code><h2 id=bandit-19>Bandit 19</h2><p>If we use <code>ls -l</code> , we can check that the owner of this file is bandit20. Thus we open the folder we need as bandit20 user and get the password. Command : <code>./bandit20-do cat /etc/bandit_pass/bandit20</code><h2 id=bandit-20>Bandit 20</h2><p>In this level, what we need is a port that gives password of level 20 as output. What we do is echo the password in a separate port that we create(I created port <code>4200</code>). We use flags <code>-l</code>(listen) <code>-p</code> (to specify port) and end the command with <code>&</code> to run it in background.<p>Commands:<ul><li><code>echo $password | nc -l -p 4200 &</code><li><code>./suconnect 4200</code></ul><p class=tags-data></main><footer><hr><div class=footContainer><div class=footLeft><p>Licensed under <a rel="noopener noreferrer" href=https://fr.wikipedia.org/wiki/Licence_MIT target=_blank>MIT</a><br></div><div class=footRight><img class="footGif noStyle" alt=footGif loading=lazy src=https://i.ibb.co/XYDpfcs/foot.gif><a rel="noopener noreferrer" title="Subscribe via RSS for updates." class=metaData href=https://exploiitm.github.io/blog/atom.xml target=_blank>RSS</a></div></div></footer>