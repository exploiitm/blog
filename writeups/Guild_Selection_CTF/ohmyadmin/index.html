<!doctype html><html lang=en><head><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],["\\[","\\]"]],processEscapes:true,processEnvironments:true}}</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=UTF-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1,user-scalable=no" name=viewport><meta content="index, follow" name=robots><title>Oh my admin</title><meta content="Oh my admin" name=title><meta content=exploiitm name=author><meta content="Official blog of Cybersecurity Club, IIT Madras" name=description><meta content=website property=og:type><meta content=https://exploiitm.github.io/blog/writeups/Guild_Selection_CTF/ohmyadmin/ property=og:url><meta content="exploiitm blog" property=og:site_name><meta content="Oh my admin" property=og:title><meta content="Official blog of Cybersecurity Club, IIT Madras" property=og:description><meta content=https://exploiitm.github.io/blog/favicon.ico property=og:image><meta content=summary_large_image property=twitter:card><meta content=https://exploiitm.github.io/blog/writeups/Guild_Selection_CTF/ohmyadmin/ property=twitter:url><meta content="Oh my admin" property=twitter:title><meta content="Official blog of Cybersecurity Club, IIT Madras" property=twitter:description><meta content=https://exploiitm.github.io/blog/favicon.ico property=twitter:image><link href=https://exploiitm.github.io/blog/writeups/Guild_Selection_CTF/ohmyadmin/ rel=canonical><link rel="shortcut icon" href=https://exploiitm.github.io/blog/favicon.ico type=image/x-icon><link href=https://speyll.github.io/suCSS/reset-min.css rel=stylesheet><link href=https://speyll.github.io/suCSS/suCSS-min.css rel=stylesheet><link href=https://exploiitm.github.io/blog/css/style.css rel=stylesheet><script defer src=https://exploiitm.github.io/blog/js/script.js></script><body><header><nav id=nav-bar><a href=https://exploiitm.github.io/> home </a><a href=/blog> blog </a><a href=/blog/writeups> writeups </a><a href=/blog/about> about </a><a href=/blog/contacts> contact </a><div><input id=theme-toggle style=display:none type=checkbox><label for=theme-toggle id=theme-toggle-label><svg class=icons id=theme-icon><use href=https://exploiitm.github.io/blog/icons.svg#lightMode></use></svg></label><audio id=theme-sound><source src=https://exploiitm.github.io/blog/click.ogg type=audio/ogg></audio></div></nav></header><main><div><a href=..>..</a>/<span class=accent-data>ohmyadmin</span></div><time datetime=2024-09-05>Published on: <span class=accent-data>2024-09-05</span></time><address rel=author>By <span class=accent-data> Achintya J, and exploiitm </span></address><h1>Oh my admin</h1><p>In this challenge, we’ve been given a login page and asked to sign in as admin. When we enter the credentials,<pre style=background:#282828;color:#fdf4c1aa><code><span>	username: admin
</span><span>	password: admin
</span></code></pre><p>we get the message: <strong>“Wrong SessID”</strong><p>What this means is, the server internally checks the user’s request for the session ID to verify if they’re really admin. We can intercept this request using <code>burpsuite</code>.<ol><li><p>Launch burpsuite, head over to the proxy tab and open a new browser instance. (if you don’t have burpsuite installed, it’s a pretty simple process so don’t worry, just google)</p><li><p>In the new browser, enter url and then switch the intercept mode on.</p><li><p>use credentials as mentioned above and inspect the request</p></ol><p>you’ll see a header named <code>session_id</code> which contains a <code>base64 encoded string</code>. We decode it to find that its of the format <code>&LTusername>&LTsomeNumber></code>(in our case <code>admin&LTsomenumber></code>). For some specific number this will give us the flag (atleast that’s what comes to mind initially).<p>However, there exists a sneakier way. What we want to do, is raise an exception in the server, and see if we get traceback messages. This means we can read the backend code that is being implemented and read the flag directly!<ol start=4><li><p>Raise an exception by <code>passing an empty string as the session_id</code>. This will throw an Error and allow you to see the traceback. Now that we’ve verified we can see the traceback, we’ll get to reading the code</p><li><p>In the session_id we are entering a base64 encoded string. This implies that there is a possibility for the backend server to have a <code>base64 decode statement</code> in it’s main function. Since, we know its running a python based flask server, it’ll probably be using the base64 library to decode.</p></ol><p>Hence, one crazy thing we can do is <code>mess with the base64 characters</code>. If we enter invalid base64 characters in the session_id it will throw an error and allow us to do a traceback. If we do this, there is a special function which is throwing an error (as expected, its the <code>base64.decode()</code> part which didn’t work) and upon clicking on it, the flag is visible in plaintext!<p>Turns out that the session_id was <code>admin&LTnumber></code> but the number ain’t visible, but that don’t matter anymore anyway.<p><code>flag: FLAG{b6k3d_c00k13ez}</code><p class=tags-data></main><footer><hr><div class=footContainer><div class=footLeft><p>Licensed under <a rel="noopener noreferrer" href=https://fr.wikipedia.org/wiki/Licence_MIT target=_blank>MIT</a><br></div><div class=footRight><img class="footGif noStyle" alt=footGif loading=lazy src=https://i.ibb.co/XYDpfcs/foot.gif><a rel="noopener noreferrer" title="Subscribe via RSS for updates." class=metaData href=https://exploiitm.github.io/blog/atom.xml target=_blank>RSS</a></div></div></footer>