<!doctype html><html lang=en><head><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],["\\[","\\]"]],processEscapes:true,processEnvironments:true}}</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=UTF-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1,user-scalable=no" name=viewport><meta content="index, follow" name=robots><title>Braiding Bad</title><meta content="Braiding Bad" name=title><meta content=exploiitm name=author><meta content="Official blog of Cybersecurity Club, IIT Madras" name=description><meta content=website property=og:type><meta content=https://exploiitm.github.io/blog/writeups/bi0sCTF-2025/braiding-bad/ property=og:url><meta content="exploiitm blog" property=og:site_name><meta content="Braiding Bad" property=og:title><meta content="Official blog of Cybersecurity Club, IIT Madras" property=og:description><meta content=https://exploiitm.github.io/blog/favicon.ico property=og:image><meta content=summary_large_image property=twitter:card><meta content=https://exploiitm.github.io/blog/writeups/bi0sCTF-2025/braiding-bad/ property=twitter:url><meta content="Braiding Bad" property=twitter:title><meta content="Official blog of Cybersecurity Club, IIT Madras" property=twitter:description><meta content=https://exploiitm.github.io/blog/favicon.ico property=twitter:image><link href=https://exploiitm.github.io/blog/writeups/bi0sCTF-2025/braiding-bad/ rel=canonical><link rel="shortcut icon" href=https://exploiitm.github.io/blog/favicon.ico type=image/x-icon><link href=https://speyll.github.io/suCSS/reset-min.css rel=stylesheet><link href=https://speyll.github.io/suCSS/suCSS-min.css rel=stylesheet><link href=https://exploiitm.github.io/blog/css/style.css rel=stylesheet><script defer src=https://exploiitm.github.io/blog/js/script.js></script><body><header><nav id=nav-bar><a href=https://exploiitm.github.io/> home </a><a href=/blog> blog </a><a href=/blog/writeups> writeups </a><a href=/blog/about> about </a><a href=/blog/contacts> contact </a><div><input id=theme-toggle style=display:none type=checkbox><label for=theme-toggle id=theme-toggle-label><svg class=icons id=theme-icon><use href=https://exploiitm.github.io/blog/icons.svg#lightMode></use></svg></label><audio id=theme-sound><source src=https://exploiitm.github.io/blog/click.ogg type=audio/ogg></audio></div></nav></header><main><div><a href=..>..</a>/<span class=accent-data>braiding-bad</span></div><time datetime=2025-06-27>Published on: <span class=accent-data>2025-06-27</span></time><address rel=author>By <span class=accent-data> Swaminath Shiju, and exploiitm </span></address><h1>Braiding Bad</h1><h3 id=description>Description</h3><p>Once upon a time , a braid decided to break bad â€¦<pre class=language-py data-lang=py style=background:#282828;color:#fdf4c1aa><code class=language-py data-lang=py><span style=color:#fa5c4b>import </span><span>random
</span><span style=color:#fa5c4b>import </span><span>string
</span><span style=color:#fa5c4b>import </span><span>hashlib
</span><span style=color:#fa5c4b>from </span><span>Crypto.Util.number </span><span style=color:#fa5c4b>import </span><span>bytes_to_long
</span><span>
</span><span>message </span><span style=color:#fe8019>= <</span><span style=color:#fdf4c1>REDACTED</span><span style=color:#fe8019>>
</span><span>
</span><span>n </span><span style=color:#fe8019>= </span><span style=color:#d3869b>100
</span><span>Bn </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>BraidGroup(n)
</span><span>gs </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>Bn.gens()
</span><span>K </span><span style=color:#fe8019>= </span><span style=color:#d3869b>32
</span><span>
</span><span>gen </span><span style=color:#fe8019>= </span><span>gs[n </span><span style=color:#fe8019>// </span><span style=color:#d3869b>2 </span><span style=color:#fe8019>- </span><span style=color:#d3869b>1</span><span>]
</span><span>p_list </span><span style=color:#fe8019>= </span><span>[gen] </span><span style=color:#fe8019>+ </span><span style=color:#fdf4c1>random.choices(gs, k</span><span style=color:#fe8019>=</span><span style=color:#fdf4c1>K</span><span style=color:#fe8019>-</span><span style=color:#d3869b>1</span><span style=color:#fdf4c1>)
</span><span>p </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>prod(p_list)
</span><span style=color:#fabd2f>print</span><span style=color:#fdf4c1>(</span><span style=color:#fa5c4b>f</span><span style=color:#b8bb26>"p: </span><span style=color:#fdf4c1>{</span><span style=color:#fabd2f>list</span><span style=color:#fdf4c1>(p.Tietze())}</span><span style=color:#b8bb26>"</span><span style=color:#fdf4c1>)
</span><span>
</span><span>a </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>prod(random.choices(gs[:n</span><span style=color:#fe8019>//</span><span style=color:#d3869b>2</span><span style=color:#fe8019>-</span><span style=color:#d3869b>2</span><span style=color:#fdf4c1>], k</span><span style=color:#fe8019>=</span><span style=color:#fdf4c1>K))
</span><span>q </span><span style=color:#fe8019>= </span><span>a </span><span style=color:#fe8019>* </span><span>p </span><span style=color:#fe8019>* </span><span>a</span><span style=color:#fe8019>^-</span><span style=color:#d3869b>1
</span><span style=color:#fabd2f>print</span><span style=color:#fdf4c1>(</span><span style=color:#fa5c4b>f</span><span style=color:#b8bb26>"q: </span><span style=color:#fdf4c1>{</span><span style=color:#fabd2f>list</span><span style=color:#fdf4c1>(q.Tietze())}</span><span style=color:#b8bb26>"</span><span style=color:#fdf4c1>)
</span><span>
</span><span>br </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>prod(random.choices(gs[n</span><span style=color:#fe8019>//</span><span style=color:#d3869b>2 </span><span style=color:#fe8019>+ </span><span style=color:#d3869b>1</span><span style=color:#fdf4c1>:], k</span><span style=color:#fe8019>=</span><span style=color:#fdf4c1>K))
</span><span>c1 </span><span style=color:#fe8019>= </span><span>br </span><span style=color:#fe8019>* </span><span>p </span><span style=color:#fe8019>* </span><span>br</span><span style=color:#fe8019>^-</span><span style=color:#d3869b>1
</span><span>c2 </span><span style=color:#fe8019>= </span><span>br </span><span style=color:#fe8019>* </span><span>q </span><span style=color:#fe8019>* </span><span>br</span><span style=color:#fe8019>^-</span><span style=color:#d3869b>1
</span><span>
</span><span>h </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>hashlib.sha512(</span><span style=color:#fabd2f>str</span><span style=color:#fdf4c1>(prod(c2.right_normal_form())).encode()).digest()
</span><span>
</span><span>original_message_len </span><span style=color:#fe8019>= </span><span style=color:#fabd2f>len</span><span style=color:#fdf4c1>(message)
</span><span>pad_length </span><span style=color:#fe8019>= </span><span style=color:#fabd2f>len</span><span style=color:#fdf4c1>(h) </span><span style=color:#fe8019>- </span><span>original_message_len
</span><span>left_length </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>random.randint(</span><span style=color:#d3869b>0</span><span style=color:#fdf4c1>, pad_length)
</span><span>pad1 </span><span style=color:#fe8019>= </span><span style=color:#b8bb26>''</span><span style=color:#fdf4c1>.join(random.choices(string.ascii_letters, k</span><span style=color:#fe8019>=</span><span style=color:#fdf4c1>left_length)).encode(</span><span style=color:#b8bb26>'utf-8'</span><span style=color:#fdf4c1>)
</span><span>pad2 </span><span style=color:#fe8019>= </span><span style=color:#b8bb26>''</span><span style=color:#fdf4c1>.join(random.choices(string.ascii_letters, k</span><span style=color:#fe8019>=</span><span style=color:#fdf4c1>pad_length </span><span style=color:#fe8019>- </span><span style=color:#fdf4c1>left_length)).encode(</span><span style=color:#b8bb26>'utf-8'</span><span style=color:#fdf4c1>)
</span><span>padded_message </span><span style=color:#fe8019>= </span><span>pad1 </span><span style=color:#fe8019>+ </span><span>message </span><span style=color:#fe8019>+ </span><span>pad2
</span><span>
</span><span>d_str </span><span style=color:#fe8019>= </span><span style=color:#b8bb26>''</span><span style=color:#fdf4c1>.join(</span><span style=color:#fabd2f>chr</span><span style=color:#fdf4c1>(m </span><span style=color:#fe8019>^^ </span><span style=color:#fdf4c1>h) </span><span style=color:#fa5c4b>for </span><span style=color:#fdf4c1>m, h </span><span style=color:#fa5c4b>in </span><span style=color:#fabd2f>zip</span><span style=color:#fdf4c1>(padded_message, h))
</span><span>d </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>bytes_to_long(d_str.encode(</span><span style=color:#b8bb26>'utf-8'</span><span style=color:#fdf4c1>))
</span><span>
</span><span style=color:#fabd2f>print</span><span style=color:#fdf4c1>(</span><span style=color:#fa5c4b>f</span><span style=color:#b8bb26>"c1: </span><span style=color:#fdf4c1>{</span><span style=color:#fabd2f>list</span><span style=color:#fdf4c1>(c1.Tietze())}</span><span style=color:#b8bb26>"</span><span style=color:#fdf4c1>)
</span><span style=color:#fabd2f>print</span><span style=color:#fdf4c1>(</span><span style=color:#fa5c4b>f</span><span style=color:#b8bb26>"c2: </span><span style=color:#fdf4c1>{d}</span><span style=color:#b8bb26>"</span><span style=color:#fdf4c1>)
</span></code></pre><h3 id=solution>Solution</h3><p>The challenge uses a simple encryption based on Braid groups to encrypt the flag.<p><code>Bn</code> is a braid group of order 100. <code>gs</code> is the list of generators, it multiplies <code>K</code> random generators to make an element <code>p</code> of <code>Bn</code>. <code>p.Tietze()</code> simply gives the list of generators used to create <code>p</code>.<p>For example if $\text{p}=\sigma_1\sigma_{11}\sigma_{34}^{-1}\sigma_4^2$ then $$\text{p.Tietze()}=(1,11,-34,4,4)$$<blockquote><p>Note: The Tietze of <code>p</code> would have only positive elements since its made from generators.</blockquote><p>This means we can directly use the printed value to get the <code>p</code> from the printed <code>Tietze</code>. The final encoding is done by converting the normal form of <code>c2</code> into bytes, sha512 hashing it and then xor-ing it with the flag. For the purposes of this question we can take <code>normal_form</code> as simply a black box to convert a group element to bytes.<p>So getting the flag reduces to finding <code>c2</code>. Assume $\text{br}=\sigma_{a_1}\sigma_{a_2}\cdots\sigma_{a_{32}}$ then <code>c1</code> would be $\left(\sigma_{a_1}\sigma_{a_2}\cdots\sigma_{a_{32}}\right)\cdot p \cdot\left(\sigma_{a_{32}}^{-1}\sigma_{a_{31}}^{-1}\cdots\sigma_{a_1}^{-1}\right)$. The printed Tietze list would simply be $$(a_1,a_2,\cdots,a_{32},[,, p,,],-a_{32},-a_{31},\cdots,-a_1)$$ We can get <code>br</code> from the first 32 elements of the Tietze. Now since we have <code>br</code> and <code>q</code> we get <code>c2</code> and then just pass it through the encryption to get the xor valued need to decrypting.<blockquote><p><strong>Note:</strong> It is possible for the end point of <code>p</code> to cancel out with the end-point of <code>c1</code>. This is improbable but easily fixable using the Tietze of <code>p</code></blockquote><p>Final solve script<pre class=language-py data-lang=py style=background:#282828;color:#fdf4c1aa><code class=language-py data-lang=py><span style=color:#fa5c4b>from </span><span>sage.groups.braid </span><span style=color:#fa5c4b>import </span><span>BraidGroup
</span><span style=color:#fa5c4b>from </span><span>sage.all </span><span style=color:#fa5c4b>import </span><span>prod
</span><span style=color:#fa5c4b>import </span><span>hashlib
</span><span>
</span><span style=color:#fabd2f>print</span><span style=color:#fdf4c1>(</span><span style=color:#b8bb26>"READY"</span><span style=color:#fdf4c1>)
</span><span>Bn </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>BraidGroup(</span><span style=color:#d3869b>100</span><span style=color:#fdf4c1>)
</span><span>
</span><span style=font-style:italic;color:#928374># not required unless cancellation happens
</span><span style=font-style:italic;color:#928374># p = Bn(&LTTietze of p>)
</span><span style=font-style:italic;color:#928374># c1 = Bn(&LTTietze of c1>)
</span><span>
</span><span>q </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>Bn(</span><span style=color:#fe8019><</span><span style=color:#fdf4c1>Tietze of q</span><span style=color:#fe8019>></span><span style=color:#fdf4c1>)
</span><span>br </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>Bn(</span><span style=color:#fe8019><</span><span style=color:#fdf4c1>Tietze of c1</span><span style=color:#fe8019>></span><span style=color:#fdf4c1>[:</span><span style=color:#d3869b>32</span><span style=color:#fdf4c1>])
</span><span>c2 </span><span style=color:#fe8019>= </span><span>br </span><span style=color:#fe8019>* </span><span>q </span><span style=color:#fe8019>* </span><span>br</span><span style=color:#fe8019>**</span><span>(</span><span style=color:#fe8019>-</span><span style=color:#d3869b>1</span><span>)
</span><span>
</span><span style=color:#fa5c4b>from </span><span>Crypto.Util.number </span><span style=color:#fa5c4b>import </span><span>long_to_bytes
</span><span>
</span><span>ct </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>long_to_bytes(</span><span style=color:#fe8019><</span><span style=color:#fdf4c1>encoded</span><span style=color:#fe8019>></span><span style=color:#fdf4c1>).decode(</span><span style=color:#b8bb26>'utf-8'</span><span style=color:#fdf4c1>)
</span><span style=color:#fabd2f>print</span><span style=color:#fdf4c1>(</span><span style=color:#b8bb26>"READY"</span><span style=color:#fdf4c1>)
</span><span>
</span><span>h </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>hashlib.sha512(</span><span style=color:#fabd2f>str</span><span style=color:#fdf4c1>(prod(c2.right_normal_form())).encode()).digest()
</span><span style=color:#fabd2f>print</span><span style=color:#fdf4c1>(</span><span style=color:#b8bb26>""</span><span style=color:#fdf4c1>.join(</span><span style=color:#fabd2f>chr</span><span style=color:#fdf4c1>(a </span><span style=color:#fe8019>^ </span><span style=color:#fabd2f>ord</span><span style=color:#fdf4c1>(b)) </span><span style=color:#fa5c4b>for </span><span style=color:#fdf4c1>a, b </span><span style=color:#fa5c4b>in </span><span style=color:#fabd2f>zip</span><span style=color:#fdf4c1>(h, ct)))
</span></code></pre><p class=tags-data></main><footer><hr><div class=footContainer><div class=footLeft><p>Licensed under <a rel="noopener noreferrer" href=https://fr.wikipedia.org/wiki/Licence_MIT target=_blank>MIT</a><br></div><div class=footRight><img class="footGif noStyle" alt=footGif loading=lazy src=https://i.ibb.co/XYDpfcs/foot.gif><a rel="noopener noreferrer" title="Subscribe via RSS for updates." class=metaData href=https://exploiitm.github.io/blog/atom.xml target=_blank>RSS</a></div></div></footer>