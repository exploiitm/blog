<!doctype html><html lang=en><head><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],["\\[","\\]"]],processEscapes:true,processEnvironments:true}}</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=UTF-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1,user-scalable=no" name=viewport><meta content="index, follow" name=robots><title>Vasthavikamaina Token Exploit</title><meta content="Vasthavikamaina Token Exploit" name=title><meta content=exploiitm name=author><meta content="Official blog of Cybersecurity Club, IIT Madras" name=description><meta content=website property=og:type><meta content=https://exploiitm.github.io/blog/writeups/bi0sCTF-2025/Vastavikamaina_Token_Writeup/ property=og:url><meta content="exploiitm blog" property=og:site_name><meta content="Vasthavikamaina Token Exploit" property=og:title><meta content="Official blog of Cybersecurity Club, IIT Madras" property=og:description><meta content=https://exploiitm.github.io/blog/favicon.ico property=og:image><meta content=summary_large_image property=twitter:card><meta content=https://exploiitm.github.io/blog/writeups/bi0sCTF-2025/Vastavikamaina_Token_Writeup/ property=twitter:url><meta content="Vasthavikamaina Token Exploit" property=twitter:title><meta content="Official blog of Cybersecurity Club, IIT Madras" property=twitter:description><meta content=https://exploiitm.github.io/blog/favicon.ico property=twitter:image><link href=https://exploiitm.github.io/blog/writeups/bi0sCTF-2025/Vastavikamaina_Token_Writeup/ rel=canonical><link rel="shortcut icon" href=https://exploiitm.github.io/blog/favicon.ico type=image/x-icon><link href=https://speyll.github.io/suCSS/reset-min.css rel=stylesheet><link href=https://speyll.github.io/suCSS/suCSS-min.css rel=stylesheet><link href=https://exploiitm.github.io/blog/css/style.css rel=stylesheet><script defer src=https://exploiitm.github.io/blog/js/script.js></script><body><header><nav id=nav-bar><a href=https://exploiitm.github.io/> home </a><a href=/blog> blog </a><a href=/blog/writeups> writeups </a><a href=/blog/about> about </a><a href=/blog/contacts> contact </a><div><input id=theme-toggle style=display:none type=checkbox><label for=theme-toggle id=theme-toggle-label><svg class=icons id=theme-icon><use href=https://exploiitm.github.io/blog/icons.svg#lightMode></use></svg></label><audio id=theme-sound><source src=https://exploiitm.github.io/blog/click.ogg type=audio/ogg></audio></div></nav></header><main><div><a href=..>..</a>/<span class=accent-data>Vastavikamaina_Token_Writeup</span></div><time datetime=2025-07-15>Published on: <span class=accent-data>2025-07-15</span></time><address rel=author>By <span class=accent-data> Vrishab, and exploiitm </span></address><h1>Vasthavikamaina Token Exploit</h1><h2 id=overview>Overview</h2><p>This exploit leverages a critical vulnerability in the <code>addVasthavikamainaLiquidity</code> function to manipulate AMM pool economics and extract profit without bearing the debt burden. The system creates three different machines (pools), but one of them, named “CowrieBO” (uniPair2), is set up with very little starting money; only 0.05 ETH. This makes it very easy to manipulate.<h2 id=the-vulnerability>The Vulnerability</h2><p>The <code>addVasthavikamainaLiquidity</code> function contains a fatal flaw:<ul><li>It sends loans directly to Uniswap pairs - which are the AMM pools<li>The <code>msg.sender</code> only provides matching tokens proportionally<li>LP tokens are burned to <code>address(0)</code>, making the liquidity permanent<li><strong>Result</strong>: Massive liquidity gets added at manipulated prices with zero debt for us</ul><h2 id=attack-steps>Attack Steps</h2><h3 id=1-initial-setup>1. Initial Setup</h3><ul><li>Flash loan WETH from Balancer contract for capital, which must be repaid in the same transaction<li>Convert WETH to VSTETH via <code>cashIn()</code></ul><h3 id=2-price-manipulation>2. Price Manipulation</h3><ul><li>Execute <code>buyQuote()</code> on target pool (preferably Pool 2 - CowrieBO)<li>This drains pool reserves and inflates lamboToken price<li>Small initial buy (0.05 ETH) means maximum price impact</ul><h3 id=3-liquidity-amplification-core-exploit>3. Liquidity Amplification (Core Exploit)</h3><pre class=language-solidity data-lang=solidity style=background:#282828;color:#fdf4c1aa><code class=language-solidity data-lang=solidity><span>factory.addVasthavikamainaLiquidity(VSTETH, lamboToken, 300 ether, 0);
</span></code></pre><ul><li>Function calculates: <code>lamboTokensNeeded = (300 ETH * reserve1) / reserve0</code><li><strong>300 ETH loan goes directly to the machine</strong> (not to us)<li>We only transfer the calculated lamboTokens (which is very less due to the flaw)<li>Pool’s K-value jumps from small amount to massive: <code>K = (reserve0 + 300e18) × (reserve1 + proportional_tokens)</code></ul><h3 id=4-profit-extraction>4. Profit Extraction</h3><ul><li>Sell remaining lamboTokens back to the enhanced pool<li>The amplified liquidity provides much better exchange rates<li>Pool now has deep liquidity at the inflated price we set</ul><h2 id=why-this-works>Why This Works</h2><ol><li><strong>Debt Isolation</strong>: The 300 ETH debt belongs to the Uniswap pair, not us<li><strong>K-Value Manipulation</strong>: Adding massive liquidity at inflated prices creates favorable AMM constants<li><strong>Permanent Enhancement</strong>: Burned LP tokens mean the enhanced liquidity can’t be withdrawn<li><strong>Arbitrage Profit</strong>: Selling back tokens yields more ETH than originally invested due to the deeper, manipulated pool</ol><h2 id=economic-impact>Economic Impact</h2><ul><li>Input: ~6.35 ETH (flash loan + small buys)<li>Output: >141.3 ETH profit<li>The exploit tricks the AMM into providing permanent liquidity at prices controlled by us</ul><h2 id=target-pool>Target Pool</h2><p><strong>Pool 2 (CowrieBO)</strong> is optimal because:<ul><li>Minimal initial buy (0.05 ETH)<li>Lowest starting lamboToken price<li>Thereby maximum manipulation potential per ETH spent</ul><p class=tags-data></main><footer><hr><div class=footContainer><div class=footLeft><p>Licensed under <a rel="noopener noreferrer" href=https://fr.wikipedia.org/wiki/Licence_MIT target=_blank>MIT</a><br></div><div class=footRight><img class="footGif noStyle" alt=footGif loading=lazy src=https://i.ibb.co/XYDpfcs/foot.gif><a rel="noopener noreferrer" title="Subscribe via RSS for updates." class=metaData href=https://exploiitm.github.io/blog/atom.xml target=_blank>RSS</a></div></div></footer>